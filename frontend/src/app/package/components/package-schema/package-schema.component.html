<div class="schema" id="schema">
    <div class="schema-content">
        <div class="schema-stats">
            <span class="schema-samples text-light-gray mb-0" *ngIf="schema.recordCount > 0">
                {{ schema.recordCount | number }} {{ schema.unit || "" }} records<br />
            </span>
            <span class="text-light-gray mb-0">{{ schemaPropertiesLength(schema) | number }} Properties</span>
        </div>

        <div class="accordions-group mt-2">
            <mat-accordion class="schema-property" multi>
                <mat-expansion-panel
                    *ngFor="
                        let property of schema?.properties
                            | values
                            | sortBy: 'asc':'title'
                            | slice: 0:propertiesToShowCount
                    "
                    [id]="getPropertyId(property)"
                    [expanded]="getPropertyId(property) == focusedPropertyId"
                >
                    <mat-expansion-panel-header>
                        <mat-panel-title class="text-dark-gray font-14 weight-500">
                            {{ property.title }}
                        </mat-panel-title>
                        <mat-panel-description class="text-dark-gray">
                            <span>{{ getPropertyTypes(property) }}</span>
                        </mat-panel-description>
                    </mat-expansion-panel-header>
                    <div>
                        <div class="text-dark-gray mb-2">
                            <a class="cursor-pointer doc-link" (click)="editPropertyDialog(property)">Edit Property</a>
                            <span class="px-2">|</span>
                            <a class="cursor-pointer doc-link" (click)="createIssue(property)">Create Issue</a>
                            <span class="px-2">|</span>
                            <a class="cursor-pointer doc-link" (click)="copyLink(property)">Copy Link</a>
                        </div>
                        <div *ngIf="property.description?.length > 0" class="text-dark-gray weight-400 mt-2 mb-2">
                            {{ property.description }}
                        </div>
                        <div
                            class="d-flex align-items-center justify-content-between"
                            *ngFor="let type of property.valueTypes | values"
                            [ngSwitch]="type.valueType"
                        >
                            <div *ngSwitchCase="'number'">
                                <div class="text-dark-gray">
                                    <div class="weight-500">{{ type.valueType }}</div>
                                    <ul>
                                        <li>
                                            present in {{ type.recordCount | number }} ({{
                                                type.recordCount / schema.recordCount | percent
                                            }}) {{ schema.unit }} records
                                        </li>
                                        <li *ngIf="property.unit">unit: {{ property.unit }}</li>
                                        <li>max value: {{ type.numberMaxValue | number }}</li>
                                        <li>min value: {{ type.numberMinValue | number }}</li>
                                    </ul>
                                </div>
                            </div>
                            <div *ngSwitchCase="'boolean'">
                                <div class="text-dark-gray">
                                    <div class="weight-500">{{ type.valueType }}</div>
                                    <ul>
                                        <li>
                                            present in {{ type.recordCount | number }} ({{
                                                type.recordCount / schema.recordCount | percent
                                            }}) records
                                        </li>
                                    </ul>
                                </div>
                            </div>

                            <div *ngSwitchCase="'null'">
                                <div class="text-dark-gray">
                                    <div class="weight-500">{{ type.valueType }}</div>
                                    <ul>
                                        <li>
                                            present in {{ type.recordCount | number }} ({{
                                                type.recordCount / schema.recordCount | percent
                                            }}) records
                                        </li>
                                    </ul>
                                </div>
                            </div>

                            <div *ngSwitchCase="'string'">
                                <div class="text-dark-gray">
                                    <div class="weight-500">{{ type.valueType }}</div>
                                    <ul>
                                        <li>
                                            present in {{ type.recordCount | number }} records ({{
                                                type.recordCount / schema.recordCount | percent
                                            }}
                                            of total)
                                        </li>
                                        <li>max length: {{ type.stringMaxLength | number }} characters</li>
                                        <li>min length: {{ type.stringMinLength | number }} characters</li>
                                        <li *ngIf="type.stringOptions">
                                            enumerated values:
                                            <ul>
                                                <li *ngFor="let value of stringOptions(type.stringOptions)">
                                                    {{ value.name }}: {{ value.value | number }} record<span
                                                        *ngIf="value.value > 1"
                                                        >s</span
                                                    >
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                </div>
                            </div>

                            <div *ngSwitchCase="'date'">
                                <div class="text-dark-gray">
                                    <div class="weight-500">{{ type.valueType }}</div>
                                    <ul>
                                        <li>
                                            present in {{ type.recordCount | number }} ({{
                                                type.recordCount / schema.recordCount | percent
                                            }}) records
                                        </li>
                                        <li>max date: {{ type.dateMaxValue | date }}</li>
                                        <li>min date: {{ type.dateMinValue | date }}</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </mat-expansion-panel>
                <div
                    class="fade-out"
                    [class.d-none]="!shouldShowMorePropertiesButton || isShowingMorePropertiesText"
                ></div>

                <p class="text-center mt-3" *ngIf="shouldShowMorePropertiesButton">
                    <a class="app-outlined-button" (click)="toggleShowMoreProperties()">
                        {{ isShowingMorePropertiesText ? "Show Less" : "Show More" }}
                    </a>
                </p>
            </mat-accordion>
        </div>
    </div>
</div>
