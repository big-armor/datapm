<div *ngIf="state == State.LOADING">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <div class="loading-spinner loading-pane">
                    <mat-spinner class="" [diameter]="60"></mat-spinner>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="container" *ngIf="state == State.ERROR">
    <div class="row">
        <div class="col-12 mt-5">
            <div class="alert-warning alert">
                There was a problem loading this page. Please refresh your browser. If that doesn't work, please contact
                support.
            </div>
        </div>
    </div>
</div>

<div class="container" *ngIf="state == State.ERROR_NOT_AUTHENTICATED">
    <div class="row text-center">
        <div class="col-12 mt-5">
            <div class="package-title">
                {{ getPackageIdentifierFromURL() }}
            </div>
            <br />
            You must <a href="javascript:void(0);" (click)="loginClicked()">login to view this package</a>.
        </div>
    </div>
</div>

<div class="container" *ngIf="state == State.ERROR_NOT_AUTHORIZED">
    <div class="row text-center">
        <div class="col-12 mt-5">
            <div class="package-title">
                {{ getPackageIdentifierFromURL() }}
            </div>
            <br />
            You do not have permission to view this package. Please contact the author.
        </div>
    </div>
</div>

<div class="container" *ngIf="state == State.ERROR_NOT_FOUND">
    <div class="row text-center">
        <div class="col-12 mt-5">
            <div class="package-title">
                {{ getPackageIdentifierFromURL() }}
            </div>
            <br />
            The package was not found. Use the search bar above to find additional data.
        </div>
    </div>
</div>

<div *ngIf="state == State.LOADED">
    <div class="container">
        <div class="row" id="packagePage">
            <div class="col-xl-12 col-12 contentContainer pl-0 pr-0">
                <app-cover
                    class="cover-image"
                    [catalogSlug]="package?.identifier.catalogSlug"
                    [packageSlug]="package?.identifier.packageSlug"
                ></app-cover>

                <div class="p-2">
                    <div class="row" *ngIf="package">
                        <div class="col-12 package-info">
                            <!-- <div class="package-title">{{ package?.displayName }}</div> -->
                            <span
                                class="py-2 package-privacy"
                                *ngIf="this.currentUser && this.currentUser?.username == this.catalogUser?.username"
                                [class.public]="package?.isPublic"
                            >
                                {{ package?.isPublic ? "public" : "not public" }}
                            </span>
                            <div class="package-identifier">
                                <div class="identifier">
                                    <app-avatar class="user-img" *ngIf="catalogUser" [user]="catalogUser" [size]="32">
                                    </app-avatar>
                                    <div class="identifier-text text-overflow-elipses">
                                        <a [routerLink]="['/' + package?.identifier.catalogSlug]">{{
                                            package?.identifier.catalogSlug
                                        }}</a
                                        >/{{ package?.identifier.packageSlug }}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row d-lg-none">
                        <div class="col-12">
                            <app-package-info [package]="package" [packageFile]="packageFile"></app-package-info>
                        </div>
                    </div>
                    <div class="row" *ngIf="package?.latestVersion?.identifier == null">
                        <div class="col-12 alert alert-warning">
                            No version of this package has been published. Therefore it is not available to fetch.
                            Please contact the author, or check back later.
                        </div>
                    </div>

                    <div class="row" *ngIf="package?.latestVersion?.identifier != null">
                        <div class="col-md-12">
                            <ul class="p-0" id="packageRoutes">
                                <li *ngFor="let r of routes" class="list-names">
                                    <a
                                        class="cursor-pointer"
                                        (click)="tabClick(r.url)"
                                        [ngClass]="{ active: isActiveTab(r) }"
                                    >
                                        {{ r.linkName }}
                                    </a>
                                </li>
                            </ul>
                            <hr style="width: 100%" />
                        </div>
                    </div>
                    <div class="row" *ngIf="package?.latestVersion?.identifier != null">
                        <div class="col-lg-12">
                            <div class="row">
                                <div class="col-md-12" id="packageDetails">
                                    <div class="row flex-lg-row-reverse">
                                        <div class="col-lg-5 col-md-12 col-lg-push-7 right-div d-none d-lg-block">
                                            <app-package-info
                                                [package]="package"
                                                [packageFile]="packageFile"
                                            ></app-package-info>
                                        </div>
                                        <div class="col-lg-7 col-md-12 col-lg-pull-5 left-div">
                                            <div>
                                                <router-outlet></router-outlet>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
